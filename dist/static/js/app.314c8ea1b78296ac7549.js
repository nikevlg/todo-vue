webpackJsonp([1],{"029K":function(t,s){},NHnr:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("7+uW"),a={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{id:"app"}},[s("main",{staticClass:"content"},[s("router-view")],1)])},staticRenderFns:[]};var o=e("VU/8")({name:"App"},a,!1,function(t){e("gIw2")},null,null).exports,n=e("/ocq"),l=e("mvHQ"),r=e.n(l),c=e("Zrlr"),d=e.n(c),u=e("wxAW"),h=e.n(u),p=function(){function t(s){d()(this,t),this.id=this.generateId(),this.title=s||"Новый список задач",this.subtasks=[]}return h()(t,[{key:"generateId",value:function(){return"id_"+Math.random().toString(36).substr(2,9)}}]),t}(),v={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"modal-backdrop"},[e("div",{staticClass:"modal"},[e("header",{staticClass:"modal-header"},[t._t("header",[e("button",{staticClass:"btn-close icon-cancel",attrs:{type:"button"},on:{click:t.close}})])],2),t._v(" "),e("section",{staticClass:"modal-body"},[t._t("body",[t._v("\n        Удалить карточку?\n      ")])],2),t._v(" "),e("footer",{staticClass:"modal-footer"},[t._t("footer",[e("button",{staticClass:"btn-green",attrs:{type:"button"},on:{click:t.close}},[t._v("\n          Отмена\n        ")]),t._v(" "),e("button",{staticClass:"btn-green",attrs:{type:"button"},on:{click:t.confirm}},[t._v("\n          Удалить\n        ")])])],2)])])},staticRenderFns:[]};var k=e("VU/8")({name:"modal",methods:{close:function(){this.$emit("close")},confirm:function(){this.$emit("confirm")}}},v,!1,function(t){e("v1VM")},"data-v-b11ad65e",null).exports,m={components:{Modal:k},data:function(){return{todos:[],selectedTodo:null,isModalVisible:!1}},methods:{getTodos:function(){this.todos=JSON.parse(localStorage.getItem("todos")),this.todos=this.todos?this.todos:[]},createTodo:function(){var t=new p;this.todos.push(t);var s=r()(this.todos);localStorage.setItem("todos",s),this.$router.push({name:"EditTask",params:{taskId:t.id}})},deleteTodo:function(){this.todos.splice(this.selectedTodo,1);var t=r()(this.todos);localStorage.setItem("todos",t),this.closeModal()},showModal:function(t){this.isModalVisible=!0,this.selectedTodo=t},closeModal:function(){this.isModalVisible=!1}},mounted:function(){this.getTodos()}},f={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"header-tools"},[e("router-link",{attrs:{to:{name:"TaskList"},title:"На главную"}},[e("span",{staticClass:"icon-home"})]),t._v(" "),e("ul",[e("li",[e("span",{staticClass:"icon-plus",attrs:{title:"Создать карточку"},on:{click:t.createTodo}})])])],1),t._v(" "),e("div",{staticClass:"card-wrapper"},[t._l(t.todos,function(s,i){return e("article",{key:s.id,staticClass:"card"},[e("header",{staticClass:"card__header"},[e("span",{staticClass:"icon-cancel",attrs:{title:"Удалить карточку"},on:{click:function(s){return t.showModal(i)}}}),t._v(" "),e("h1",{staticClass:"text-ellipsis"},[t._v(t._s(s.title))])]),t._v(" "),e("div",{staticClass:"card__content"},[e("ul",t._l(s.subtasks.slice(0,3),function(s){return e("li",{key:s.id,staticClass:"text-ellipsis"},[e("span",{staticClass:"icon-right-open"}),t._v("\n            "+t._s(s.title)+"\n          ")])}),0)]),t._v(" "),e("footer",{staticClass:"card__footer"},[e("router-link",{attrs:{to:{name:"EditTask",params:{taskId:s.id}},title:"Редактировать"}},[e("div",{staticClass:"icon-pencil"})])],1)])}),t._v(" "),e("modal",{directives:[{name:"show",rawName:"v-show",value:t.isModalVisible,expression:"isModalVisible"}],on:{close:t.closeModal,confirm:t.deleteTodo}})],2)])},staticRenderFns:[]};var _=e("VU/8")(m,f,!1,function(t){e("reYe")},"data-v-22ccf2b0",null).exports,T=function(){function t(s){d()(this,t),this.id=this.generateId(),this.title=s||"Новая подзадача",this.complete=!1}return h()(t,[{key:"generateId",value:function(){return"id_"+Math.random().toString(36).substr(2,9)}}]),t}(),g={props:{currentTaskId:{type:String,default:""}},components:{Modal:k},data:function(){return{task:{},isModalVisible:!1,originalTask:{},lastRolledTask:null,historyTask:[]}},methods:{getTask:function(){for(var t=JSON.parse(localStorage.getItem("todos")),s=0;s<t.length;s++){if(t[s].id===this.currentTaskId){this.task=t[s];break}s===t.length-1&&this.$router.push({name:"PageNotFound"})}this.originalTask=r()(this.task),this.historyTask.push(this.originalTask)},addSubtask:function(){this.task.subtasks.push(new T),this.saveHistory()},deleteSubtask:function(t){this.task.subtasks.splice(t,1),this.saveHistory()},saveHistory:function(){this.historyTask.push(r()(this.task))},backHistory:function(){this.historyTask.length>1&&(this.lastRolledTask=this.historyTask.pop(),this.task=JSON.parse(this.historyTask[this.historyTask.length-1]))},forwardHistory:function(){this.lastRolledTask&&(this.task=JSON.parse(this.lastRolledTask),this.historyTask.push(this.lastRolledTask),this.lastRolledTask=null)},cancelChange:function(){this.task=JSON.parse(this.originalTask),this.historyTask=[],this.historyTask.push(this.originalTask)},saveTask:function(){var t=this;this.todos=JSON.parse(localStorage.getItem("todos"));var s=this.todos.findIndex(function(s){return s.id===t.currentTaskId});this.todos[s]=this.task;var e=r()(this.todos);localStorage.setItem("todos",e),this.historyTask=[],this.historyTask.push(this.originalTask)},showModal:function(){this.isModalVisible=!0},closeModal:function(){this.isModalVisible=!1},deleteTodo:function(){this.todos=JSON.parse(localStorage.getItem("todos"));for(var t=0;t<this.todos.length;t++)if(this.todos[t].id===this.currentTaskId){this.todos.splice(this.todos.indexOf(this.todos[t]),1);var s=r()(this.todos);localStorage.setItem("todos",s)}this.closeModal(),this.$router.push({name:"TaskList"})}},mounted:function(){this.getTask()}},b={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"header-tools"},[e("router-link",{attrs:{to:{name:"TaskList"},title:"На главную"}},[e("span",{staticClass:"icon-home"})]),t._v(" "),e("ul",[e("li",[e("span",{staticClass:"icon-floppy",attrs:{title:"Сохранить карточку"},on:{click:t.saveTask}})]),t._v(" "),e("li",[e("span",{staticClass:"icon-cancel",attrs:{title:"Отменить все изменения"},on:{click:t.cancelChange}})]),t._v(" "),e("li",[t._v(" ")]),t._v(" "),e("li",[e("span",{staticClass:"icon-reply",attrs:{title:"Назад"},on:{click:t.backHistory}})]),t._v(" "),e("li",[e("span",{staticClass:"icon-forward",attrs:{title:"Вперед"},on:{click:t.forwardHistory}})]),t._v(" "),e("li",[t._v(" ")]),t._v(" "),e("li",[e("span",{staticClass:"icon-trash",attrs:{title:"Удалить карточку"},on:{click:t.showModal}})])])],1),t._v(" "),e("div",{staticClass:"edit-card-wrapper"},[e("div",{staticClass:"edit-card"},[e("div",{staticClass:"edit-card__title"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.task.title,expression:"task.title"}],attrs:{type:"text",placeholder:"Введите имя карточки"},domProps:{value:t.task.title},on:{blur:t.saveHistory,input:function(s){s.target.composing||t.$set(t.task,"title",s.target.value)}}}),t._v(" "),e("span",{staticClass:"icon-plus",attrs:{title:"Добавить подзадачу"},on:{click:t.addSubtask}})]),t._v(" "),e("ul",t._l(t.task.subtasks,function(s,i){return e("li",{key:s.id,class:{cross:s.complete}},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.title,expression:"subtask.title"}],attrs:{type:"text",disabled:s.complete,placeholder:"Введите подзадачу"},domProps:{value:s.title},on:{blur:t.saveHistory,input:function(e){e.target.composing||t.$set(s,"title",e.target.value)}}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.complete,expression:"subtask.complete"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(s.complete)?t._i(s.complete,null)>-1:s.complete},on:{change:[function(e){var i=s.complete,a=e.target,o=!!a.checked;if(Array.isArray(i)){var n=t._i(i,null);a.checked?n<0&&t.$set(s,"complete",i.concat([null])):n>-1&&t.$set(s,"complete",i.slice(0,n).concat(i.slice(n+1)))}else t.$set(s,"complete",o)},t.saveHistory]}}),t._v(" "),e("span",{staticClass:"icon-cancel",on:{click:function(s){return t.deleteSubtask(i)}}})])}),0)]),t._v(" "),e("modal",{directives:[{name:"show",rawName:"v-show",value:t.isModalVisible,expression:"isModalVisible"}],on:{close:t.closeModal,confirm:function(s){return t.deleteTodo(t.index)}}})],1)])},staticRenderFns:[]};var y=e("VU/8")(g,b,!1,function(t){e("Ti/Z")},"data-v-1b58315d",null).exports,C={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"not-found"},[s("h1",[this._v("404")]),this._v(" "),s("div",[this._v("Страница не найдена")]),this._v(" "),s("router-link",{attrs:{to:{name:"TaskList"},title:"На главную"}},[this._v("\n   На главную\n  ")])],1)},staticRenderFns:[]};var w=e("VU/8")({data:function(){return{}}},C,!1,function(t){e("029K")},"data-v-2a7cf031",null).exports;i.a.use(n.a);var M=new n.a({hashbang:!1,mode:"history",routes:[{path:"*",name:"PageNotFound",component:w},{path:"/edit/*",name:"PageNotFound",component:w},{path:"/",name:"TaskList",component:_},{path:"/edit/:taskId",name:"EditTask",component:y,props:function(t){return{currentTaskId:t.params.taskId}}}]});i.a.config.productionTip=!1,new i.a({el:"#app",router:M,components:{App:o},template:"<App/>"})},"Ti/Z":function(t,s){},gIw2:function(t,s){},reYe:function(t,s){},v1VM:function(t,s){}},["NHnr"]);
//# sourceMappingURL=app.314c8ea1b78296ac7549.js.map